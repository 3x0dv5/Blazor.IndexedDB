!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1);var r;!function(e){const t="TimeGhost",n={IndexedDbManager:new o.IndexedDbManager};e.initialise=function(){"undefined"==typeof window||window[t]?window[t]=Object.assign({},window[t],n):window[t]=Object.assign({},n)}}(r||(r={})),r.initialise()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2);t.IndexedDbManager=class{constructor(){this.assemblyName="Blazor.IndexedDB",this.promiseCallback="PromiseCallback",this.promiseError="PromiseError",this.runFunction=((e,t,n)=>(console.log("Start runFunction"),this[t](n).then(t=>{void 0===t&&(t="");const n=JSON.stringify(t);DotNet.invokeMethodAsync(this.assemblyName,this.promiseCallback,e,n)}).catch(t=>{const n=JSON.stringify(t);DotNet.invokeMethodAsync(this.assemblyName,this.promiseError,e,n)}),!0)),this.isOpen=!1,this.openDb=(e=>{var t=e;return new Promise((e,n)=>{this.db=new o.default(t.dbName,t.version,(e,n,o)=>{if(t.stores)for(let n=0;n<t.stores.length;n++){const o=t.stores[n];if(!e.objectStoreNames.contains(o.name)){let t=o.primaryKey;t||(t={name:"id",keyPath:"id",auto:!0});const n=e.createObjectStore(o.name,{keyPath:t.name,autoIncrement:t.auto});for(let e=0;e<o.indexes.length;e++){const t=o.indexes[e];n.createIndex(t.name,t.keyPath,{unique:t.unique})}}}}),e(`${t.dbName} is opened`)})}),this.addRecord=(e=>{const t=e.storename,n=e.data,o=this.db.transaction(t,"readwrite",(e,o)=>{const r=e.objectStore(t);return console.log(r),new Promise((e,t)=>{const o=r.add(n);o.onsuccess=(t=>e()),o.onerror=(e=>t())})});return new Promise((e,t)=>{o.then(t=>{console.log("Insertion successful"),console.log("result",t),e("record added")}).catch(e=>{t("Failed to add record")})})}),this.getRecords=(e=>{const t=this.db.transaction(e,"readonly",(t,n)=>{const r=t.objectStore(e);return console.log(r),new o.default((e,t)=>{const n=r.getAll();n.onsuccess=(t=>e(n)),n.onerror=(e=>t())})});return new Promise((e,n)=>{t.then(t=>{console.log("get successful"),console.log("result",t),e(t)}).catch(e=>{n(null)})})}),this.getObjectStore=((e,t)=>this.db.transaction(e,t).objectStore(e))}}},function(e,t,n){"use strict";n.r(t);var o=function(){function e(e,t,n){this.db_=this._request(indexedDB.open(e,t),function(e){e.onupgradeneeded=function(o){var r=e.result;n(r,o.oldVersion,o.newVersion||t)}}).catch(function(t){console.warn("PromisedDB: failed to open / upgrade database '"+e+"'",t)}),this.tctx_={request:this._request.bind(this),cursor:this._cursor.bind(this),keyCursor:this._keyCursor.bind(this),getAll:this._getAll.bind(this),getAllKeys:this._getAllKeys.bind(this)}}return e.prototype.close=function(){this.db_.then(function(e){e.close()})},e.prototype.transaction=function(e,t,n){var o=this;return this.db_.then(function(r){return new Promise(function(i,s){var c=r.transaction(e,t);c.onerror=function(){a(),s(c.error||"transaction failed")},c.onabort=function(){a(),s("aborted")};var u=null,a=function(){null!==u&&(clearTimeout(u),u=null)},l=Object.create(o.tctx_,{timeout:{value:function(e){u=setTimeout(function(){u=null,c.abort()},e)}}}),d=n(c,l);c.oncomplete=function(){a(),i(d)}})})},e.prototype._request=function(e,t){var n=new Promise(function(n,o){e.onerror=function(){o(e.error||"request failed")},e.onsuccess=function(){n(e.result)},t&&t(e)});return this.db_?this.db_.then(function(){return n}):n},e.prototype._cursorImpl=function(e){var t={next:function(e){return this.callbackFn_=e,this},complete:function(e){return this.completeFn_=e,this},catch:function(e){return this.errorFn_=e,this}};return e.onerror=function(){t.errorFn_&&t.errorFn_(e.error)},e.onsuccess=function(){var n=e.result;n?t.callbackFn_&&t.callbackFn_(n):t.completeFn_&&t.completeFn_()},t},e.prototype._cursor=function(e,t,n){var o=e.openCursor(t,n);return this._cursorImpl(o)},e.prototype._keyCursor=function(e,t,n){var o=e.openKeyCursor(t,n);return this._cursorImpl(o)},e.prototype._getAll=function(e,t,n,o){var r=this;return new Promise(function(i,s){var c=[];r._cursor(e,t,n).next(function(e){c.push(e.value),o&&c.length===o?i(c):e.continue()}).complete(function(){i(c)}).catch(function(e){s(e)})})},e.prototype._getAllKeys=function(e,t,n,o){var r=this;return new Promise(function(i,s){var c=[];r._keyCursor(e,t,n).next(function(e){c.push(e.primaryKey),o&&c.length===o?i(c):e.continue()}).complete(function(){i(c)}).catch(function(e){s(e)})})},e}();t.default=o}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL0luaXRpYWxpc2VJbmRleERiQmxhem9yLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleGVkRGJCbGF6b3IudHMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb21pc2VkLWRiL3Byb21pc2VkLWRiLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiaW5kZXhlZERiQmxhem9yXzEiLCJJbmRleERiIiwidGltZWdob3N0RXh0ZW5zaW9ucyIsImV4dGVuc2lvbk9iamVjdCIsIkluZGV4ZWREYk1hbmFnZXIiLCJpbml0aWFsaXNlIiwid2luZG93IiwiYXNzaWduIiwicHJvbWlzZWRfZGJfMSIsIltvYmplY3QgT2JqZWN0XSIsInRoaXMiLCJhc3NlbWJseU5hbWUiLCJwcm9taXNlQ2FsbGJhY2siLCJwcm9taXNlRXJyb3IiLCJydW5GdW5jdGlvbiIsImNhbGxiYWNrSWQiLCJmbk5hbWUiLCJkYXRhIiwiY29uc29sZSIsImxvZyIsInRoZW4iLCJ1bmRlZmluZWQiLCJyZXN1bHQiLCJKU09OIiwic3RyaW5naWZ5IiwiRG90TmV0IiwiaW52b2tlTWV0aG9kQXN5bmMiLCJjYXRjaCIsInJlYXNvbiIsImlzT3BlbiIsIm9wZW5EYiIsImRiU3RvcmUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImRiIiwiZGVmYXVsdCIsImRiTmFtZSIsInZlcnNpb24iLCJvbkRpc2tWZXJzaW9uIiwibmV3VmVyc2lvbiIsInN0b3JlcyIsImxlbmd0aCIsInN0b3JlU2NoZW1hIiwib2JqZWN0U3RvcmVOYW1lcyIsImNvbnRhaW5zIiwicHJpbWFyeUtleSIsImtleVBhdGgiLCJhdXRvIiwic3RvcmUiLCJjcmVhdGVPYmplY3RTdG9yZSIsImF1dG9JbmNyZW1lbnQiLCJqIiwiaW5kZXhlcyIsImluZGV4IiwiY3JlYXRlSW5kZXgiLCJ1bmlxdWUiLCJhZGRSZWNvcmQiLCJyZWNvcmQiLCJzdE5hbWUiLCJzdG9yZW5hbWUiLCJpdGVtVG9TYXZlIiwidHJhbnMiLCJ0cmFuc2FjdGlvbiIsInRyIiwicmVxdWVzdCIsIm9iamVjdFN0b3JlIiwiYWRkIiwib25zdWNjZXNzIiwiZXYiLCJvbmVycm9yIiwiZXJyb3IiLCJnZXRSZWNvcmRzIiwic3RvcmVOYW1lIiwiZ2V0QWxsIiwiZ2V0T2JqZWN0U3RvcmUiLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwiUHJvbWlzZWREQiIsInVwZ3JhZGUiLCJkYl8iLCJfcmVxdWVzdCIsImluZGV4ZWREQiIsIm9wZW4iLCJvcGVuUmVxIiwib251cGdyYWRlbmVlZGVkIiwidXBncmFkZUV2dCIsIm9sZFZlcnNpb24iLCJ3YXJuIiwidGN0eF8iLCJjdXJzb3IiLCJfY3Vyc29yIiwia2V5Q3Vyc29yIiwiX2tleUN1cnNvciIsIl9nZXRBbGwiLCJnZXRBbGxLZXlzIiwiX2dldEFsbEtleXMiLCJjbG9zZSIsInN0b3JlTmFtZXMiLCJmbiIsIl90aGlzIiwiY2FuY2VsVGltZW91dCIsIm9uYWJvcnQiLCJ0aW1lb3V0SUQiLCJjbGVhclRpbWVvdXQiLCJ0YyIsInRpbWVvdXQiLCJtcyIsInNldFRpbWVvdXQiLCJhYm9ydCIsIm9uY29tcGxldGUiLCJyZXEiLCJyZXFQcm9tIiwiX2N1cnNvckltcGwiLCJjdXJzb3JSZXEiLCJuZXh0IiwiY2FsbGJhY2siLCJjYWxsYmFja0ZuXyIsImNvbXBsZXRlIiwiY29tcGxldGVGbl8iLCJlcnJvckZuXyIsImNvbnRhaW5lciIsInJhbmdlIiwiZGlyZWN0aW9uIiwib3BlbkN1cnNvciIsIm9wZW5LZXlDdXJzb3IiLCJsaW1pdCIsImN1ciIsInB1c2giLCJjb250aW51ZSJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFiLEVBQUFpQixPQUFBQyxhQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFN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RUFBQUcsR0FDQSxJQUFBMUIsRUFBQXpGLEtBQ0EsV0FBQXNCLFFBQUEsU0FBQUMsRUFBQUMsR0FDQSxJQUFBWixLQUNBNkUsRUFBQVQsUUFBQThCLEVBQUFDLEVBQUFDLEdBQ0FSLEtBQUEsU0FBQVksR0FDQXhHLEVBQUF5RyxLQUFBRCxFQUFBN0ksT0FDQTRJLEdBQUF2RyxFQUFBb0IsU0FBQW1GLEVBQ0E1RixFQUFBWCxHQUdBd0csRUFBQUUsYUFHQVgsU0FBQSxXQUNBcEYsRUFBQVgsS0FFQUssTUFBQSxTQUFBNEMsR0FDQXJDLEVBQUFxQyxRQUlBTSxFQUFBakYsVUFBQW1HLFlBQUEsU0FBQXlCLEVBQUFDLEVBQUFDLEVBQUFHLEdBQ0EsSUFBQTFCLEVBQUF6RixLQUNBLFdBQUFzQixRQUFBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQVosS0FDQTZFLEVBQUFQLFdBQUE0QixFQUFBQyxFQUFBQyxHQUNBUixLQUFBLFNBQUFZLEdBQ0F4RyxFQUFBeUcsS0FBQUQsRUFBQWhGLFlBQ0ErRSxHQUFBdkcsRUFBQW9CLFNBQUFtRixFQUNBNUYsRUFBQVgsR0FHQXdHLEVBQUFFLGFBR0FYLFNBQUEsV0FDQXBGLEVBQUFYLEtBRUFLLE1BQUEsU0FBQTRDLEdBQ0FyQyxFQUFBcUMsUUFJQU0sRUFsS0EsR0FvS0FELEVBQUEiLCJmaWxlIjoiaW5kZXhlZERiLkJsYXpvci5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbiIsImltcG9ydCB7IEluZGV4ZWREYk1hbmFnZXIgfSBmcm9tICcuL2luZGV4ZWREYkJsYXpvcic7XHJcblxyXG5uYW1lc3BhY2UgSW5kZXhEYiB7XHJcbiAgICBjb25zdCB0aW1lZ2hvc3RFeHRlbnNpb25zOiBzdHJpbmcgPSAnVGltZUdob3N0JztcclxuICAgIGNvbnN0IGV4dGVuc2lvbk9iamVjdCA9IHtcclxuICAgICAgICBJbmRleGVkRGJNYW5hZ2VyOiBuZXcgSW5kZXhlZERiTWFuYWdlcigpXHJcbiAgICB9O1xyXG5cclxuICAgIGV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXNlKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiAhd2luZG93W3RpbWVnaG9zdEV4dGVuc2lvbnNdKSB7XHJcbiAgICAgICAgICAgIHdpbmRvd1t0aW1lZ2hvc3RFeHRlbnNpb25zXSA9IHtcclxuICAgICAgICAgICAgICAgIC4uLmV4dGVuc2lvbk9iamVjdFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHdpbmRvd1t0aW1lZ2hvc3RFeHRlbnNpb25zXSA9IHtcclxuICAgICAgICAgICAgICAgIC4uLndpbmRvd1t0aW1lZ2hvc3RFeHRlbnNpb25zXSxcclxuICAgICAgICAgICAgICAgIC4uLmV4dGVuc2lvbk9iamVjdFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbn1cclxuXHJcbkluZGV4RGIuaW5pdGlhbGlzZSgpOyIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJNaWNyb3NvZnQuSlNJbnRlcm9wLmQudHNcIi8+XHJcbmltcG9ydCBQcm9taXNlZERCIGZyb20gJ3Byb21pc2VkLWRiJztcclxuXHJcblxyXG5pbnRlcmZhY2UgSVNpbmdsZVJlY29yZCB7XHJcbiAgICBzdG9yZW5hbWU6IHN0cmluZztcclxuICAgIGRhdGE6IG9iamVjdDtcclxufVxyXG5cclxuaW50ZXJmYWNlIElJbmRleFNwZWMge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAga2V5UGF0aDogc3RyaW5nO1xyXG4gICAgdW5pcXVlPzogYm9vbGVhbjtcclxuICAgIGF1dG86IGJvb2xlYW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBJU3RvcmVTY2hlbWEge1xyXG4gICAgZGJWZXJzaW9uPzogbnVtYmVyO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgcHJpbWFyeUtleTogSUluZGV4U3BlYztcclxuICAgIGluZGV4ZXM6IElJbmRleFNwZWNbXTtcclxufVxyXG5cclxuaW50ZXJmYWNlIElEYlN0b3JlIHtcclxuICAgIGRiTmFtZTogc3RyaW5nO1xyXG4gICAgdmVyc2lvbjogbnVtYmVyO1xyXG4gICAgc3RvcmVzOiBJU3RvcmVTY2hlbWFbXTtcclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBJbmRleGVkRGJNYW5hZ2VyIHtcclxuICAgIHByaXZhdGUgYXNzZW1ibHlOYW1lID0gJ0JsYXpvci5JbmRleGVkREInO1xyXG4gICAgcHJpdmF0ZSBwcm9taXNlQ2FsbGJhY2sgPSAnUHJvbWlzZUNhbGxiYWNrJztcclxuICAgIHByaXZhdGUgcHJvbWlzZUVycm9yID0gJ1Byb21pc2VFcnJvcic7IHB1YmxpYyBydW5GdW5jdGlvbiA9IChjYWxsYmFja0lkOiBzdHJpbmcsIGZuTmFtZTogc3RyaW5nLCBkYXRhOiBhbnkpOiBib29sZWFuID0+IHtcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1N0YXJ0IHJ1bkZ1bmN0aW9uJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHByb21pc2UgPSB0aGlzW2ZuTmFtZV0oZGF0YSk7XHJcblxyXG4gICAgICAgIHByb21pc2UudGhlbih2YWx1ZSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICcnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcclxuICAgICAgICAgICAgRG90TmV0Lmludm9rZU1ldGhvZEFzeW5jKHRoaXMuYXNzZW1ibHlOYW1lLCB0aGlzLnByb21pc2VDYWxsYmFjaywgY2FsbGJhY2tJZCwgcmVzdWx0KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2gocmVhc29uID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IEpTT04uc3RyaW5naWZ5KHJlYXNvbik7XHJcbiAgICAgICAgICAgICAgICBEb3ROZXQuaW52b2tlTWV0aG9kQXN5bmModGhpcy5hc3NlbWJseU5hbWUsIHRoaXMucHJvbWlzZUVycm9yLCBjYWxsYmFja0lkLCByZXN1bHQpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGlzT3BlbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBkYjogUHJvbWlzZWREQjtcclxuXHJcblxyXG5cclxuICAgIHB1YmxpYyBvcGVuRGIgPSAoZGF0YSk6IFByb21pc2U8c3RyaW5nPiA9PiB7XHJcbiAgICAgICAgdmFyIGRiU3RvcmUgPSBkYXRhIGFzIElEYlN0b3JlO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxzdHJpbmc+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5kYiA9IG5ldyBQcm9taXNlZERCKGRiU3RvcmUuZGJOYW1lLCBkYlN0b3JlLnZlcnNpb24sXHJcbiAgICAgICAgICAgICAgICAoZGIsIG9uRGlza1ZlcnNpb24sIG5ld1ZlcnNpb24pID0+IHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRiU3RvcmUuc3RvcmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGJTdG9yZS5zdG9yZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlU2NoZW1hID0gZGJTdG9yZS5zdG9yZXNbaV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkYi5vYmplY3RTdG9yZU5hbWVzLmNvbnRhaW5zKHN0b3JlU2NoZW1hLm5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHByaW1hcnlLZXkgPSBzdG9yZVNjaGVtYS5wcmltYXJ5S2V5O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXByaW1hcnlLZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWFyeUtleSA9IHsgbmFtZTogJ2lkJywga2V5UGF0aDogJ2lkJywgYXV0bzogdHJ1ZSB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoc3RvcmVTY2hlbWEubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBrZXlQYXRoOiBwcmltYXJ5S2V5Lm5hbWUsIGF1dG9JbmNyZW1lbnQ6IHByaW1hcnlLZXkuYXV0byB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzdG9yZVNjaGVtYS5pbmRleGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gc3RvcmVTY2hlbWEuaW5kZXhlc1tqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuY3JlYXRlSW5kZXgoaW5kZXgubmFtZSwgaW5kZXgua2V5UGF0aCwgeyB1bmlxdWU6IGluZGV4LnVuaXF1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXNvbHZlKGAke2RiU3RvcmUuZGJOYW1lfSBpcyBvcGVuZWRgKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICAgIHB1YmxpYyBhZGRSZWNvcmQgPSAocmVjb3JkOiBJU2luZ2xlUmVjb3JkKTogUHJvbWlzZTxhbnk+ID0+IHtcclxuICAgICAgICBjb25zdCBzdE5hbWUgPSByZWNvcmQuc3RvcmVuYW1lO1xyXG4gICAgICAgIGNvbnN0IGl0ZW1Ub1NhdmUgPSByZWNvcmQuZGF0YTtcclxuICAgICAgICAvL2NvbnN0IHN0b3JlID0gdGhpcy5nZXRPYmplY3RTdG9yZShzdE5hbWUsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICBjb25zdCB0cmFucyA9IHRoaXMuZGIudHJhbnNhY3Rpb24oc3ROYW1lLCAncmVhZHdyaXRlJywgKHRyLCByZXF1ZXN0KSA9PiB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzdG9yZTogSURCT2JqZWN0U3RvcmUgPSB0ci5vYmplY3RTdG9yZShzdE5hbWUpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdG9yZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1Qcm9taXNlID0gbmV3IFByb21pc2U8YW55PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXF1ZXN0ID0gc3RvcmUuYWRkKGl0ZW1Ub1NhdmUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZXYgPT4gcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZXYgPT4gcmVqZWN0KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1Qcm9taXNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8YW55PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRyYW5zXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdJbnNlcnRpb24gc3VjY2Vzc2Z1bCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXN1bHQnLCByZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwicmVjb3JkIGFkZGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdGYWlsZWQgdG8gYWRkIHJlY29yZCcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFJlY29yZHMgPSAoc3RvcmVOYW1lOiBzdHJpbmcpOiBQcm9taXNlPGFueT4gPT4ge1xyXG5cclxuICAgICAgICBjb25zdCB0cmFucyA9IHRoaXMuZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLFxyXG4gICAgICAgICAgICBcInJlYWRvbmx5XCIsXHJcbiAgICAgICAgICAgICh0ciwgZ2V0QWxsKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdG9yZSA9IHRyLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdG9yZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBnZXRQcm9taXNlID0gbmV3IFByb21pc2VkREI8YW55PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IHN0b3JlLmdldEFsbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZXYgPT4gcmVzb2x2ZShyZXF1ZXN0KTtcclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBldiA9PiByZWplY3QoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFByb21pc2U7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8YW55PigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRyYW5zXHJcbiAgICAgICAgICAgICAgICAudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdnZXQgc3VjY2Vzc2Z1bCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZXN1bHQnLCByZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QobnVsbCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgfVxyXG4gICAgcHVibGljIGdldE9iamVjdFN0b3JlID0gKHN0b3JlTmFtZTogc3RyaW5nLCBtb2RlOiAncmVhZG9ubHknIHwgJ3JlYWR3cml0ZScgfCAndmVyc2lvbmNoYW5nZScgfCB1bmRlZmluZWQpOiBJREJPYmplY3RTdG9yZSA9PiB7XHJcbiAgICAgICAgY29uc3QgdHg6IElEQlRyYW5zYWN0aW9uID0gdGhpcy5kYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIG1vZGUpO1xyXG4gICAgICAgIHJldHVybiB0eC5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG59IiwiLy8gcHJvbWlzZWQtZGIgLSBJbmRleGVkREIgd3JhcHBlZCBpbiBhIHByb21pc2UtYmFzZWQgQVBJIHdpdGggY29udGV4dHVhbCBtZXRob2RzIGFuZCB0aW1lb3V0IHN1cHBvcnQuIChodHRwczovL2dpdGh1Yi5jb20vemVubXVtYmxlci9wcm9taXNlZC1kYilcbi8vIChjKSAyMDE2LVByZXNlbnQgYnkgQXJ0aHVyIExhbmdlcmVpcyAoQHplbm11bWJsZXIpXG52YXIgUHJvbWlzZWREQiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUHJvbWlzZWREQihuYW1lLCB2ZXJzaW9uLCB1cGdyYWRlKSB7XG4gICAgICAgIHRoaXMuZGJfID0gdGhpcy5fcmVxdWVzdChpbmRleGVkREIub3BlbihuYW1lLCB2ZXJzaW9uKSwgZnVuY3Rpb24gKG9wZW5SZXEpIHtcbiAgICAgICAgICAgIG9wZW5SZXEub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24gKHVwZ3JhZGVFdnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGIgPSBvcGVuUmVxLnJlc3VsdDtcbiAgICAgICAgICAgICAgICB1cGdyYWRlKGRiLCB1cGdyYWRlRXZ0Lm9sZFZlcnNpb24sIHVwZ3JhZGVFdnQubmV3VmVyc2lvbiB8fCB2ZXJzaW9uKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJQcm9taXNlZERCOiBmYWlsZWQgdG8gb3BlbiAvIHVwZ3JhZGUgZGF0YWJhc2UgJ1wiICsgbmFtZSArIFwiJ1wiLCBlcnJvcik7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyB0aGUgVHJhbnNhY3Rpb25Db250ZXh0IGlzIGltcGxlbWVudGVkIGFzIHRoZSBwcml2YXRlIG1ldGhvZHMgaW4gUERCXG4gICAgICAgIC8vIGJvdW5kIHRvIHRoaXMgYW5kIGV4cG9zZWQgYXMgbG9vc2UgZnVuY3Rpb25zLlxuICAgICAgICB0aGlzLnRjdHhfID0ge1xuICAgICAgICAgICAgcmVxdWVzdDogdGhpcy5fcmVxdWVzdC5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgY3Vyc29yOiB0aGlzLl9jdXJzb3IuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGtleUN1cnNvcjogdGhpcy5fa2V5Q3Vyc29yLmJpbmQodGhpcyksXG4gICAgICAgICAgICBnZXRBbGw6IHRoaXMuX2dldEFsbC5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgZ2V0QWxsS2V5czogdGhpcy5fZ2V0QWxsS2V5cy5iaW5kKHRoaXMpXG4gICAgICAgIH07XG4gICAgfVxuICAgIFByb21pc2VkREIucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmRiXy50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICAgICAgZGIuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQcm9taXNlZERCLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uIChzdG9yZU5hbWVzLCBtb2RlLCBmbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5kYl8udGhlbihmdW5jdGlvbiAoZGIpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyID0gZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lcywgbW9kZSk7XG4gICAgICAgICAgICAgICAgdHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsVGltZW91dCgpO1xuICAgICAgICAgICAgICAgICAgICByZWplY3QodHIuZXJyb3IgfHwgXCJ0cmFuc2FjdGlvbiBmYWlsZWRcIik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0ci5vbmFib3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjYW5jZWxUaW1lb3V0KCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChcImFib3J0ZWRcIik7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB2YXIgdGltZW91dElEID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgY2FuY2VsVGltZW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVvdXRJRCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJRCk7IC8vIG1ha2UgdGltZW91dHMgd29yayBmb3IgYm90aCB3ZWIgYW5kIG5vZGUgY29udGV4dHNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJRCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB0YyA9IE9iamVjdC5jcmVhdGUoX3RoaXMudGN0eF8sIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIChtcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJRCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0SUQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIG1zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBmbih0ciwgdGMpO1xuICAgICAgICAgICAgICAgIHRyLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbFRpbWVvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQcm9taXNlZERCLnByb3RvdHlwZS5fcmVxdWVzdCA9IGZ1bmN0aW9uIChyZXEsIGZuKSB7XG4gICAgICAgIHZhciByZXFQcm9tID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVxLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7IHJlamVjdChyZXEuZXJyb3IgfHwgXCJyZXF1ZXN0IGZhaWxlZFwiKTsgfTtcbiAgICAgICAgICAgIHJlcS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7IHJlc29sdmUocmVxLnJlc3VsdCk7IH07XG4gICAgICAgICAgICBpZiAoZm4pIHtcbiAgICAgICAgICAgICAgICBmbihyZXEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGJfID8gdGhpcy5kYl8udGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiByZXFQcm9tOyB9KSA6IHJlcVByb207XG4gICAgfTtcbiAgICBQcm9taXNlZERCLnByb3RvdHlwZS5fY3Vyc29ySW1wbCA9IGZ1bmN0aW9uIChjdXJzb3JSZXEpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHtcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tGbl8gPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZUZuXyA9IGNhbGxiYWNrO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhdGNoOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVycm9yRm5fID0gY2FsbGJhY2s7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGN1cnNvclJlcS5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5lcnJvckZuXykge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5lcnJvckZuXyhjdXJzb3JSZXEuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjdXJzb3JSZXEub25zdWNjZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGN1cnNvciA9IGN1cnNvclJlcS5yZXN1bHQ7XG4gICAgICAgICAgICBpZiAoY3Vyc29yKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jYWxsYmFja0ZuXykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuY2FsbGJhY2tGbl8oY3Vyc29yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNvbXBsZXRlRm5fKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jb21wbGV0ZUZuXygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFByb21pc2VkREIucHJvdG90eXBlLl9jdXJzb3IgPSBmdW5jdGlvbiAoY29udGFpbmVyLCByYW5nZSwgZGlyZWN0aW9uKSB7XG4gICAgICAgIHZhciBjdXJzb3JSZXEgPSBjb250YWluZXIub3BlbkN1cnNvcihyYW5nZSwgZGlyZWN0aW9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnNvckltcGwoY3Vyc29yUmVxKTtcbiAgICB9O1xuICAgIC8vIElEQiAyIGhhcyBJREJPYmplY3RTdG9yZS5vcGVuS2V5Q3Vyc29yLCBidXQgMSBkb2VzIG5vdFxuICAgIFByb21pc2VkREIucHJvdG90eXBlLl9rZXlDdXJzb3IgPSBmdW5jdGlvbiAoaW5kZXgsIHJhbmdlLCBkaXJlY3Rpb24pIHtcbiAgICAgICAgdmFyIGN1cnNvclJlcSA9IGluZGV4Lm9wZW5LZXlDdXJzb3IocmFuZ2UsIGRpcmVjdGlvbik7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJzb3JJbXBsKGN1cnNvclJlcSk7XG4gICAgfTtcbiAgICBQcm9taXNlZERCLnByb3RvdHlwZS5fZ2V0QWxsID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgcmFuZ2UsIGRpcmVjdGlvbiwgbGltaXQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgICAgIF90aGlzLl9jdXJzb3IoY29udGFpbmVyLCByYW5nZSwgZGlyZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5uZXh0KGZ1bmN0aW9uIChjdXIpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChjdXIudmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChsaW1pdCAmJiAocmVzdWx0Lmxlbmd0aCA9PT0gbGltaXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGN1ci5jb250aW51ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNvbXBsZXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUHJvbWlzZWREQi5wcm90b3R5cGUuX2dldEFsbEtleXMgPSBmdW5jdGlvbiAoY29udGFpbmVyLCByYW5nZSwgZGlyZWN0aW9uLCBsaW1pdCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgX3RoaXMuX2tleUN1cnNvcihjb250YWluZXIsIHJhbmdlLCBkaXJlY3Rpb24pXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGN1cikge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGN1ci5wcmltYXJ5S2V5KTtcbiAgICAgICAgICAgICAgICBpZiAobGltaXQgJiYgKHJlc3VsdC5sZW5ndGggPT09IGxpbWl0KSkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXIuY29udGludWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jb21wbGV0ZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBQcm9taXNlZERCO1xufSgpKTtcbmV4cG9ydCBkZWZhdWx0IFByb21pc2VkREI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9taXNlZC1kYi5qcy5tYXAiXSwic291cmNlUm9vdCI6IiJ9