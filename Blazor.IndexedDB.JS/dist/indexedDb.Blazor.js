!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);var o;!function(e){const t="TimeGhost",n={IndexedDbManager:new r.IndexedDbManager};e.initialise=function(){"undefined"==typeof window||window[t]?window[t]=Object.assign({},window[t],n):window[t]=Object.assign({},n)}}(o||(o={})),o.initialise()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(2);t.IndexedDbManager=class{constructor(){this.assemblyName="Blazor.IndexedDB",this.promiseCallback="PromiseCallback",this.promiseError="PromiseError",this.isOpen=!1,this.runFunction=((e,t,n)=>(console.log("Start runFunction"),this[t](n).then(t=>{void 0===t&&(t="");const n=JSON.stringify(t);DotNet.invokeMethodAsync(this.assemblyName,this.promiseCallback,e,n)}).catch(t=>{const n=JSON.stringify(t);DotNet.invokeMethodAsync(this.assemblyName,this.promiseError,e,n)}),!0)),this.openDb=(e=>{var t=e;return new Promise((e,n)=>{this.db=new r.default(t.name,t.version,(e,n,r)=>{if(t.tables)for(let n=0;n<t.tables.length;n++){const r=t.tables[n];if(!e.objectStoreNames.contains(r.name)){const t=r.primaryKey,n=e.createObjectStore(r.name,{keyPath:t.name,autoIncrement:t.auto});for(let e=0;e<r.indexes.length;e++){const t=r.indexes[e];n.createIndex(t.name,t.keyPath,{unique:t.unique})}}}}),e(`${t.name} is opened`)})}),this.addRecord=(e=>{const t=e.storename,n=e.data,r=this.db.transaction(t,"readwrite",(e,r)=>{const o=e.objectStore(t);return console.log(o),new Promise((e,t)=>{const r=o.add(n);r.onsuccess=(t=>e()),r.onerror=(e=>t())})});return new Promise((e,t)=>{r.then(t=>{console.log("Insertion successful"),console.log("result",t),e("record added")}).catch(e=>{t("Failed to add record")})})}),this.getObjectStore=((e,t)=>this.db.transaction(e,t).objectStore(e))}}},function(e,t,n){"use strict";n.r(t);var r=function(){function e(e,t,n){this.db_=this._request(indexedDB.open(e,t),function(e){e.onupgradeneeded=function(r){var o=e.result;n(o,r.oldVersion,r.newVersion||t)}}).catch(function(t){console.warn("PromisedDB: failed to open / upgrade database '"+e+"'",t)}),this.tctx_={request:this._request.bind(this),cursor:this._cursor.bind(this),keyCursor:this._keyCursor.bind(this),getAll:this._getAll.bind(this),getAllKeys:this._getAllKeys.bind(this)}}return e.prototype.close=function(){this.db_.then(function(e){e.close()})},e.prototype.transaction=function(e,t,n){var r=this;return this.db_.then(function(o){return new Promise(function(i,s){var c=o.transaction(e,t);c.onerror=function(){a(),s(c.error||"transaction failed")},c.onabort=function(){a(),s("aborted")};var u=null,a=function(){null!==u&&(clearTimeout(u),u=null)},l=Object.create(r.tctx_,{timeout:{value:function(e){u=setTimeout(function(){u=null,c.abort()},e)}}}),d=n(c,l);c.oncomplete=function(){a(),i(d)}})})},e.prototype._request=function(e,t){var n=new Promise(function(n,r){e.onerror=function(){r(e.error||"request failed")},e.onsuccess=function(){n(e.result)},t&&t(e)});return this.db_?this.db_.then(function(){return n}):n},e.prototype._cursorImpl=function(e){var t={next:function(e){return this.callbackFn_=e,this},complete:function(e){return this.completeFn_=e,this},catch:function(e){return this.errorFn_=e,this}};return e.onerror=function(){t.errorFn_&&t.errorFn_(e.error)},e.onsuccess=function(){var n=e.result;n?t.callbackFn_&&t.callbackFn_(n):t.completeFn_&&t.completeFn_()},t},e.prototype._cursor=function(e,t,n){var r=e.openCursor(t,n);return this._cursorImpl(r)},e.prototype._keyCursor=function(e,t,n){var r=e.openKeyCursor(t,n);return this._cursorImpl(r)},e.prototype._getAll=function(e,t,n,r){var o=this;return new Promise(function(i,s){var c=[];o._cursor(e,t,n).next(function(e){c.push(e.value),r&&c.length===r?i(c):e.continue()}).complete(function(){i(c)}).catch(function(e){s(e)})})},e.prototype._getAllKeys=function(e,t,n,r){var o=this;return new Promise(function(i,s){var c=[];o._keyCursor(e,t,n).next(function(e){c.push(e.primaryKey),r&&c.length===r?i(c):e.continue()}).complete(function(){i(c)}).catch(function(e){s(e)})})},e}();t.default=r}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL0luaXRpYWxpc2VJbmRleERiQmxhem9yLnRzIiwid2VicGFjazovLy8uL3NyYy9pbmRleGVkRGJCbGF6b3IudHMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3Byb21pc2VkLWRiL3Byb21pc2VkLWRiLmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiaW5kZXhlZERiQmxhem9yXzEiLCJJbmRleERiIiwidGltZWdob3N0RXh0ZW5zaW9ucyIsImV4dGVuc2lvbk9iamVjdCIsIkluZGV4ZWREYk1hbmFnZXIiLCJpbml0aWFsaXNlIiwid2luZG93IiwiYXNzaWduIiwicHJvbWlzZWRfZGJfMSIsIltvYmplY3QgT2JqZWN0XSIsInRoaXMiLCJhc3NlbWJseU5hbWUiLCJwcm9taXNlQ2FsbGJhY2siLCJwcm9taXNlRXJyb3IiLCJpc09wZW4iLCJydW5GdW5jdGlvbiIsImNhbGxiYWNrSWQiLCJmbk5hbWUiLCJkYXRhIiwiY29uc29sZSIsImxvZyIsInRoZW4iLCJ1bmRlZmluZWQiLCJyZXN1bHQiLCJKU09OIiwic3RyaW5naWZ5IiwiRG90TmV0IiwiaW52b2tlTWV0aG9kQXN5bmMiLCJjYXRjaCIsInJlYXNvbiIsIm9wZW5EYiIsImRiU3RvcmUiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImRiIiwiZGVmYXVsdCIsInZlcnNpb24iLCJvbkRpc2tWZXJzaW9uIiwibmV3VmVyc2lvbiIsInRhYmxlcyIsImxlbmd0aCIsInRhYmxlIiwib2JqZWN0U3RvcmVOYW1lcyIsImNvbnRhaW5zIiwicHJpbWFyeUtleSIsInN0b3JlIiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJrZXlQYXRoIiwiYXV0b0luY3JlbWVudCIsImF1dG8iLCJqIiwiaW5kZXhlcyIsImluZGV4IiwiY3JlYXRlSW5kZXgiLCJ1bmlxdWUiLCJhZGRSZWNvcmQiLCJyZWNvcmQiLCJzdE5hbWUiLCJzdG9yZW5hbWUiLCJpdGVtVG9TYXZlIiwidHJhbnMiLCJ0cmFuc2FjdGlvbiIsInRyIiwicmVxdWVzdCIsIm9iamVjdFN0b3JlIiwiYWRkIiwib25zdWNjZXNzIiwiZXYiLCJvbmVycm9yIiwiZXJyb3IiLCJnZXRPYmplY3RTdG9yZSIsInN0b3JlTmFtZSIsIl9fd2VicGFja19leHBvcnRzX18iLCJQcm9taXNlZERCIiwidXBncmFkZSIsImRiXyIsIl9yZXF1ZXN0IiwiaW5kZXhlZERCIiwib3BlbiIsIm9wZW5SZXEiLCJvbnVwZ3JhZGVuZWVkZWQiLCJ1cGdyYWRlRXZ0Iiwib2xkVmVyc2lvbiIsIndhcm4iLCJ0Y3R4XyIsImN1cnNvciIsIl9jdXJzb3IiLCJrZXlDdXJzb3IiLCJfa2V5Q3Vyc29yIiwiZ2V0QWxsIiwiX2dldEFsbCIsImdldEFsbEtleXMiLCJfZ2V0QWxsS2V5cyIsImNsb3NlIiwic3RvcmVOYW1lcyIsImZuIiwiX3RoaXMiLCJjYW5jZWxUaW1lb3V0Iiwib25hYm9ydCIsInRpbWVvdXRJRCIsImNsZWFyVGltZW91dCIsInRjIiwidGltZW91dCIsIm1zIiwic2V0VGltZW91dCIsImFib3J0Iiwib25jb21wbGV0ZSIsInJlcSIsInJlcVByb20iLCJfY3Vyc29ySW1wbCIsImN1cnNvclJlcSIsIm5leHQiLCJjYWxsYmFjayIsImNhbGxiYWNrRm5fIiwiY29tcGxldGUiLCJjb21wbGV0ZUZuXyIsImVycm9yRm5fIiwiY29udGFpbmVyIiwicmFuZ2UiLCJkaXJlY3Rpb24iLCJvcGVuQ3Vyc29yIiwib3BlbktleUN1cnNvciIsImxpbWl0IiwiY3VyIiwicHVzaCIsImNvbnRpbnVlIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLGFBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQTFCLEVBQUFrQixFQUFBTyxHQUNBWCxPQUFBQyxlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQXJCLEVBQUFVLEVBQUFlLEVB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RyxFQUFBRSxhQUdBWCxTQUFBLFdBQ0FsRixFQUFBVixLQUVBSyxNQUFBLFNBQUEwQyxHQUNBcEMsRUFBQW9DLFFBSUFJLEVBbEtBLEdBb0tBRCxFQUFBIiwiZmlsZSI6ImluZGV4ZWREYi5CbGF6b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJpbXBvcnQgeyBJbmRleGVkRGJNYW5hZ2VyIH0gZnJvbSAnLi9pbmRleGVkRGJCbGF6b3InO1xyXG5cclxubmFtZXNwYWNlIEluZGV4RGIge1xyXG4gICAgY29uc3QgdGltZWdob3N0RXh0ZW5zaW9uczogc3RyaW5nID0gJ1RpbWVHaG9zdCc7XHJcbiAgICBjb25zdCBleHRlbnNpb25PYmplY3QgPSB7XHJcbiAgICAgICAgSW5kZXhlZERiTWFuYWdlcjogbmV3IEluZGV4ZWREYk1hbmFnZXIoKVxyXG4gICAgfTtcclxuXHJcbiAgICBleHBvcnQgZnVuY3Rpb24gaW5pdGlhbGlzZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgIXdpbmRvd1t0aW1lZ2hvc3RFeHRlbnNpb25zXSkge1xyXG4gICAgICAgICAgICB3aW5kb3dbdGltZWdob3N0RXh0ZW5zaW9uc10gPSB7XHJcbiAgICAgICAgICAgICAgICAuLi5leHRlbnNpb25PYmplY3RcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB3aW5kb3dbdGltZWdob3N0RXh0ZW5zaW9uc10gPSB7XHJcbiAgICAgICAgICAgICAgICAuLi53aW5kb3dbdGltZWdob3N0RXh0ZW5zaW9uc10sXHJcbiAgICAgICAgICAgICAgICAuLi5leHRlbnNpb25PYmplY3RcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG59XHJcblxyXG5JbmRleERiLmluaXRpYWxpc2UoKTsiLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiTWljcm9zb2Z0LkpTSW50ZXJvcC5kLnRzXHJcbmltcG9ydCBQcm9taXNlZERCIGZyb20gJ3Byb21pc2VkLWRiJztcclxuXHJcblxyXG5pbnRlcmZhY2UgSVNpbmdsZVJlY29yZCB7XHJcbiAgICBzdG9yZW5hbWU6IHN0cmluZztcclxuICAgIGRhdGE6IG9iamVjdDtcclxufVxyXG5cclxuaW50ZXJmYWNlIElJbmRleFNwZWMge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAga2V5UGF0aDogc3RyaW5nO1xyXG4gICAgdW5pcXVlPzogYm9vbGVhbjtcclxuICAgIGF1dG86IGJvb2xlYW47XHJcbn1cclxuXHJcbmludGVyZmFjZSBJVGFibGVTY2hlbWEge1xyXG4gICAgZGJWZXJzaW9uPzogbnVtYmVyO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgcHJpbWFyeUtleTogSUluZGV4U3BlYztcclxuICAgIGluZGV4ZXM6IElJbmRleFNwZWNbXTtcclxufVxyXG5cclxuaW50ZXJmYWNlIElEYlN0b3JlIHtcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHZlcnNpb246IG51bWJlcjtcclxuICAgIHRhYmxlczogSVRhYmxlU2NoZW1hW107XHJcblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSW5kZXhlZERiTWFuYWdlciB7XHJcbiAgICBwcml2YXRlIGFzc2VtYmx5TmFtZSA9ICdCbGF6b3IuSW5kZXhlZERCJztcclxuICAgIHByaXZhdGUgcHJvbWlzZUNhbGxiYWNrID0gJ1Byb21pc2VDYWxsYmFjayc7XHJcbiAgICBwcml2YXRlIHByb21pc2VFcnJvciA9ICdQcm9taXNlRXJyb3InO1xyXG4gICAgcHJpdmF0ZSBpc09wZW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgZGI6IFByb21pc2VkREI7XHJcblxyXG4gICAgcHVibGljIHJ1bkZ1bmN0aW9uID0gKGNhbGxiYWNrSWQ6IHN0cmluZywgZm5OYW1lOiBzdHJpbmcsIGRhdGE6IGFueSk6IGJvb2xlYW4gPT4ge1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZygnU3RhcnQgcnVuRnVuY3Rpb24nKTtcclxuXHJcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IHRoaXNbZm5OYW1lXShkYXRhKTtcclxuXHJcbiAgICAgICAgcHJvbWlzZS50aGVuKHZhbHVlID0+IHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhbHVlID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpO1xyXG4gICAgICAgICAgICBEb3ROZXQuaW52b2tlTWV0aG9kQXN5bmModGhpcy5hc3NlbWJseU5hbWUsIHRoaXMucHJvbWlzZUNhbGxiYWNrLCBjYWxsYmFja0lkLCByZXN1bHQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChyZWFzb24gPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5zdHJpbmdpZnkocmVhc29uKTtcclxuICAgICAgICAgICAgICAgIERvdE5ldC5pbnZva2VNZXRob2RBc3luYyh0aGlzLmFzc2VtYmx5TmFtZSwgdGhpcy5wcm9taXNlRXJyb3IsIGNhbGxiYWNrSWQsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb3BlbkRiID0gKGRhdGEpOiBQcm9taXNlPHN0cmluZz4gPT4ge1xyXG4gICAgICAgIHZhciBkYlN0b3JlID0gZGF0YSBhcyBJRGJTdG9yZTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8c3RyaW5nPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZGIgPSBuZXcgUHJvbWlzZWREQihkYlN0b3JlLm5hbWUsIGRiU3RvcmUudmVyc2lvbixcclxuICAgICAgICAgICAgICAgIChkYiwgb25EaXNrVmVyc2lvbiwgbmV3VmVyc2lvbikgPT4ge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGJTdG9yZS50YWJsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYlN0b3JlLnRhYmxlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFibGUgPSBkYlN0b3JlLnRhYmxlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZGIub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyh0YWJsZS5uYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHByaW1hcnlLZXkgPSB0YWJsZS5wcmltYXJ5S2V5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUodGFibGUubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeyBrZXlQYXRoOiBwcmltYXJ5S2V5Lm5hbWUsIGF1dG9JbmNyZW1lbnQ6IHByaW1hcnlLZXkuYXV0byB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0YWJsZS5pbmRleGVzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdGFibGUuaW5kZXhlc1tqXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUuY3JlYXRlSW5kZXgoaW5kZXgubmFtZSwgaW5kZXgua2V5UGF0aCwgeyB1bmlxdWU6IGluZGV4LnVuaXF1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmVzb2x2ZShgJHtkYlN0b3JlLm5hbWV9IGlzIG9wZW5lZGApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgIHB1YmxpYyBhZGRSZWNvcmQgPSAocmVjb3JkOiBJU2luZ2xlUmVjb3JkKTogUHJvbWlzZTxhbnk+ID0+IHtcclxuICAgICAgICBjb25zdCBzdE5hbWUgPSByZWNvcmQuc3RvcmVuYW1lO1xyXG4gICAgICAgIGNvbnN0IGl0ZW1Ub1NhdmUgPSByZWNvcmQuZGF0YTtcclxuICAgICAgICAvL2NvbnN0IHN0b3JlID0gdGhpcy5nZXRPYmplY3RTdG9yZShzdE5hbWUsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICBjb25zdCB0cmFucyA9IHRoaXMuZGIudHJhbnNhY3Rpb24oc3ROYW1lLCAncmVhZHdyaXRlJywgKHRyLCByZXF1ZXN0KSA9PiB7XHJcbiAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHN0b3JlOiBJREJPYmplY3RTdG9yZSA9IHRyLm9iamVjdFN0b3JlKHN0TmFtZSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0b3JlKTtcclxuICAgICAgICAgICAgY29uc3QgaXRlbVByb21pc2UgPSBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBzdG9yZS5hZGQoaXRlbVRvU2F2ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBldiA9PiByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBldiA9PiByZWplY3QoKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gaXRlbVByb21pc2U7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZTxhbnk+KChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgdHJhbnNcclxuICAgICAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0luc2VydGlvbiBzdWNjZXNzZnVsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCcsIHJlc3VsdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJyZWNvcmQgYWRkZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ0ZhaWxlZCB0byBhZGQgcmVjb3JkJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0T2JqZWN0U3RvcmUgPSAoc3RvcmVOYW1lOiBzdHJpbmcsIG1vZGU6ICdyZWFkb25seScgfCAncmVhZHdyaXRlJyB8ICd2ZXJzaW9uY2hhbmdlJyB8IHVuZGVmaW5lZCk6IElEQk9iamVjdFN0b3JlID0+IHtcclxuICAgICAgICBjb25zdCB0eDogSURCVHJhbnNhY3Rpb24gPSB0aGlzLmRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgbW9kZSk7XHJcbiAgICAgICAgcmV0dXJuIHR4Lm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0iLCIvLyBwcm9taXNlZC1kYiAtIEluZGV4ZWREQiB3cmFwcGVkIGluIGEgcHJvbWlzZS1iYXNlZCBBUEkgd2l0aCBjb250ZXh0dWFsIG1ldGhvZHMgYW5kIHRpbWVvdXQgc3VwcG9ydC4gKGh0dHBzOi8vZ2l0aHViLmNvbS96ZW5tdW1ibGVyL3Byb21pc2VkLWRiKVxuLy8gKGMpIDIwMTYtUHJlc2VudCBieSBBcnRodXIgTGFuZ2VyZWlzIChAemVubXVtYmxlcilcbnZhciBQcm9taXNlZERCID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQcm9taXNlZERCKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGUpIHtcbiAgICAgICAgdGhpcy5kYl8gPSB0aGlzLl9yZXF1ZXN0KGluZGV4ZWREQi5vcGVuKG5hbWUsIHZlcnNpb24pLCBmdW5jdGlvbiAob3BlblJlcSkge1xuICAgICAgICAgICAgb3BlblJlcS5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbiAodXBncmFkZUV2dCkge1xuICAgICAgICAgICAgICAgIHZhciBkYiA9IG9wZW5SZXEucmVzdWx0O1xuICAgICAgICAgICAgICAgIHVwZ3JhZGUoZGIsIHVwZ3JhZGVFdnQub2xkVmVyc2lvbiwgdXBncmFkZUV2dC5uZXdWZXJzaW9uIHx8IHZlcnNpb24pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIlByb21pc2VkREI6IGZhaWxlZCB0byBvcGVuIC8gdXBncmFkZSBkYXRhYmFzZSAnXCIgKyBuYW1lICsgXCInXCIsIGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIHRoZSBUcmFuc2FjdGlvbkNvbnRleHQgaXMgaW1wbGVtZW50ZWQgYXMgdGhlIHByaXZhdGUgbWV0aG9kcyBpbiBQREJcbiAgICAgICAgLy8gYm91bmQgdG8gdGhpcyBhbmQgZXhwb3NlZCBhcyBsb29zZSBmdW5jdGlvbnMuXG4gICAgICAgIHRoaXMudGN0eF8gPSB7XG4gICAgICAgICAgICByZXF1ZXN0OiB0aGlzLl9yZXF1ZXN0LmJpbmQodGhpcyksXG4gICAgICAgICAgICBjdXJzb3I6IHRoaXMuX2N1cnNvci5iaW5kKHRoaXMpLFxuICAgICAgICAgICAga2V5Q3Vyc29yOiB0aGlzLl9rZXlDdXJzb3IuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGdldEFsbDogdGhpcy5fZ2V0QWxsLmJpbmQodGhpcyksXG4gICAgICAgICAgICBnZXRBbGxLZXlzOiB0aGlzLl9nZXRBbGxLZXlzLmJpbmQodGhpcylcbiAgICAgICAgfTtcbiAgICB9XG4gICAgUHJvbWlzZWREQi5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZGJfLnRoZW4oZnVuY3Rpb24gKGRiKSB7XG4gICAgICAgICAgICBkYi5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFByb21pc2VkREIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24gKHN0b3JlTmFtZXMsIG1vZGUsIGZuKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLmRiXy50aGVuKGZ1bmN0aW9uIChkYikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHIgPSBkYi50cmFuc2FjdGlvbihzdG9yZU5hbWVzLCBtb2RlKTtcbiAgICAgICAgICAgICAgICB0ci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjYW5jZWxUaW1lb3V0KCk7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdCh0ci5lcnJvciB8fCBcInRyYW5zYWN0aW9uIGZhaWxlZFwiKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRyLm9uYWJvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbmNlbFRpbWVvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiYWJvcnRlZFwiKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZhciB0aW1lb3V0SUQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBjYW5jZWxUaW1lb3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGltZW91dElEICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElEKTsgLy8gbWFrZSB0aW1lb3V0cyB3b3JrIGZvciBib3RoIHdlYiBhbmQgbm9kZSBjb250ZXh0c1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dElEID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdmFyIHRjID0gT2JqZWN0LmNyZWF0ZShfdGhpcy50Y3R4Xywge1xuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKG1zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dElEID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRJRCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgbXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGZuKHRyLCB0Yyk7XG4gICAgICAgICAgICAgICAgdHIub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FuY2VsVGltZW91dCgpO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFByb21pc2VkREIucHJvdG90eXBlLl9yZXF1ZXN0ID0gZnVuY3Rpb24gKHJlcSwgZm4pIHtcbiAgICAgICAgdmFyIHJlcVByb20gPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZXEub25lcnJvciA9IGZ1bmN0aW9uICgpIHsgcmVqZWN0KHJlcS5lcnJvciB8fCBcInJlcXVlc3QgZmFpbGVkXCIpOyB9O1xuICAgICAgICAgICAgcmVxLm9uc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHsgcmVzb2x2ZShyZXEucmVzdWx0KTsgfTtcbiAgICAgICAgICAgIGlmIChmbikge1xuICAgICAgICAgICAgICAgIGZuKHJlcSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5kYl8gPyB0aGlzLmRiXy50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcVByb207IH0pIDogcmVxUHJvbTtcbiAgICB9O1xuICAgIFByb21pc2VkREIucHJvdG90eXBlLl9jdXJzb3JJbXBsID0gZnVuY3Rpb24gKGN1cnNvclJlcSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja0ZuXyA9IGNhbGxiYWNrO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXRlRm5fID0gY2FsbGJhY2s7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2F0Y2g6IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JGbl8gPSBjYWxsYmFjaztcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY3Vyc29yUmVxLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAocmVzdWx0LmVycm9yRm5fKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmVycm9yRm5fKGN1cnNvclJlcS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGN1cnNvclJlcS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY3Vyc29yID0gY3Vyc29yUmVxLnJlc3VsdDtcbiAgICAgICAgICAgIGlmIChjdXJzb3IpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmNhbGxiYWNrRm5fKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5jYWxsYmFja0ZuXyhjdXJzb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuY29tcGxldGVGbl8pIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmNvbXBsZXRlRm5fKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgUHJvbWlzZWREQi5wcm90b3R5cGUuX2N1cnNvciA9IGZ1bmN0aW9uIChjb250YWluZXIsIHJhbmdlLCBkaXJlY3Rpb24pIHtcbiAgICAgICAgdmFyIGN1cnNvclJlcSA9IGNvbnRhaW5lci5vcGVuQ3Vyc29yKHJhbmdlLCBkaXJlY3Rpb24pO1xuICAgICAgICByZXR1cm4gdGhpcy5fY3Vyc29ySW1wbChjdXJzb3JSZXEpO1xuICAgIH07XG4gICAgLy8gSURCIDIgaGFzIElEQk9iamVjdFN0b3JlLm9wZW5LZXlDdXJzb3IsIGJ1dCAxIGRvZXMgbm90XG4gICAgUHJvbWlzZWREQi5wcm90b3R5cGUuX2tleUN1cnNvciA9IGZ1bmN0aW9uIChpbmRleCwgcmFuZ2UsIGRpcmVjdGlvbikge1xuICAgICAgICB2YXIgY3Vyc29yUmVxID0gaW5kZXgub3BlbktleUN1cnNvcihyYW5nZSwgZGlyZWN0aW9uKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnNvckltcGwoY3Vyc29yUmVxKTtcbiAgICB9O1xuICAgIFByb21pc2VkREIucHJvdG90eXBlLl9nZXRBbGwgPSBmdW5jdGlvbiAoY29udGFpbmVyLCByYW5nZSwgZGlyZWN0aW9uLCBsaW1pdCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICAgICAgX3RoaXMuX2N1cnNvcihjb250YWluZXIsIHJhbmdlLCBkaXJlY3Rpb24pXG4gICAgICAgICAgICAgICAgLm5leHQoZnVuY3Rpb24gKGN1cikge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGN1ci52YWx1ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGxpbWl0ICYmIChyZXN1bHQubGVuZ3RoID09PSBsaW1pdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY3VyLmNvbnRpbnVlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY29tcGxldGUoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBQcm9taXNlZERCLnByb3RvdHlwZS5fZ2V0QWxsS2V5cyA9IGZ1bmN0aW9uIChjb250YWluZXIsIHJhbmdlLCBkaXJlY3Rpb24sIGxpbWl0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgICAgICBfdGhpcy5fa2V5Q3Vyc29yKGNvbnRhaW5lciwgcmFuZ2UsIGRpcmVjdGlvbilcbiAgICAgICAgICAgICAgICAubmV4dChmdW5jdGlvbiAoY3VyKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goY3VyLnByaW1hcnlLZXkpO1xuICAgICAgICAgICAgICAgIGlmIChsaW1pdCAmJiAocmVzdWx0Lmxlbmd0aCA9PT0gbGltaXQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGN1ci5jb250aW51ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNvbXBsZXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFByb21pc2VkREI7XG59KCkpO1xuZXhwb3J0IGRlZmF1bHQgUHJvbWlzZWREQjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXByb21pc2VkLWRiLmpzLm1hcCJdLCJzb3VyY2VSb290IjoiIn0=